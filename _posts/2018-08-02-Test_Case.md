# 测试用例的编写方法

看过之前conf文件编写的应该知道，我们的参数目录在input和output中。但目前参数格式都是用json格式来编写的，这样就会出现一个问题。例如一个参数如下：

```
{
    "Bulk_Sub_Post_In":[
        {
            "ApplicantName":"admin",
            "ApplicantOrg":"3cc204834c5943ecacaacc9f8e8f41c7",
            "BeginTime":"20181101000000",
            "EndTime":"20181231000000",
            "Interface_Url":"10.85.7.62:8084",
            "Interface_st":"/VIID/Subscribes",
            "OperateType":"0",
            "Reason":"subcribe",
            "ReceiveAddr":"http://10.10.40.186/VIID/Test",
            "ResourceURI":"00000000009110000001",
            "SubscribeDetail":"11,12,13,tp,sp",
            "SubscribeID":"20180403999999999885503889408",
            "Title":"订阅"
        }
    ]
}

```

此时我们需要些三条用例，其中需要OperateType参数为0 1 2那么：
```
{
    "Bulk_Sub_Post_In":[
        {
            "ApplicantName":"admin",
            "ApplicantOrg":"3cc204834c5943ecacaacc9f8e8f41c7",
            "BeginTime":"20181101000000",
            "EndTime":"20181231000000",
            "Interface_Url":"10.85.7.62:8084",
            "Interface_st":"/VIID/Subscribes",
            "OperateType":"0",
            "Reason":"subcribe",
            "ReceiveAddr":"http://10.10.40.186/VIID/Test",
            "ResourceURI":"00000000009110000001",
            "SubscribeDetail":"11,12,13,tp,sp",
            "SubscribeID":"20180403999999999885503889408",
            "Title":"订阅"
        }，
                {
            "ApplicantName":"admin",
            "ApplicantOrg":"3cc204834c5943ecacaacc9f8e8f41c7",
            "BeginTime":"20181101000000",
            "EndTime":"20181231000000",
            "Interface_Url":"10.85.7.62:8084",
            "Interface_st":"/VIID/Subscribes",
            "OperateType":"1",
            "Reason":"subcribe",
            "ReceiveAddr":"http://10.10.40.186/VIID/Test",
            "ResourceURI":"00000000009110000001",
            "SubscribeDetail":"11,12,13,tp,sp",
            "SubscribeID":"20180403999999999885503889408",
            "Title":"订阅"
        }，
                {
            "ApplicantName":"admin",
            "ApplicantOrg":"3cc204834c5943ecacaacc9f8e8f41c7",
            "BeginTime":"20181101000000",
            "EndTime":"20181231000000",
            "Interface_Url":"10.85.7.62:8084",
            "Interface_st":"/VIID/Subscribes",
            "OperateType":"2",
            "Reason":"subcribe",
            "ReceiveAddr":"http://10.10.40.186/VIID/Test",
            "ResourceURI":"00000000009110000001",
            "SubscribeDetail":"11,12,13,tp,sp",
            "SubscribeID":"20180403999999999885503889408",
            "Title":"订阅"
        }
    ]
}

```
这条用例就是这样的了，但如果我们个个参数都要写不同的值，那么这个接口最终会是成百上千条了。

为此找到了一个比较好的解决方案，使用excel编写测试用例，然后生成json文件。

最终excel的呈现效果为：
![avatar](/img/12.png)

其中:

- excel文件名与json文件名相同
- excle的sheel的名字和json变量名相同
- sheel中的表头和参数名相同

![avatar](/img/11.png)

按照上述规则即可生成对应的json文件了。

表头需要注意的是，必须写当前字段的类型，例如需要数字就写|int，需要字符串写|str。
